{% extends './navbars/baseencuestador.html' %}

<!-- nombre de la encuesta en el title -->
{% block title %}{{titulo}}{% endblock %}

{% block body %}

<center>
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-dismissible alert-primary col-lg-4">
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        {{message}}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <!-- TITULO-->
    <fieldset class="form-group">
        <form class="col-lg-10 mt-2" action="/edit_titulo/{{id}}" method="POST">
            <input type="text" class="form-control-plaintext form-control-lg h1" name="titulo" value="{{titulo}}"
                style="text-align: center; font-size:44px">
            <input type="submit" class="btn btn-sm  btn-success rounded-pill" value="+">
        </form>
    </fieldset>

    <!-- Agregar nueva pregunta-->
    <p></p>
    <fieldset class="form-group">
        <form class="col-lg-6" action="/edit/{{id}}" method="POST">
            <div class="input-group">
                <input type="text" class="form-control form-control-sm" name="pregunta" placeholder="Nueva pregunta">
                <input type="submit" name="S" value="Alternativa" class="btn btn-primary">
                <input type="submit" name="A" value="S.Multiple" class="btn btn-primary">
                <input type="submit" name="D" value="Desarrollo" class=" btn btn-primary disabled">
            </div>
        </form>
    </fieldset>
    <p></p>
    <!-- question({id_pregunta, id_encuesta, respuestas, tipo, texto})-->

    <!-- Esto es para ver las preguntas dado un id de encuesta -->
    <!-- Para cada pregunta -->
    {% for question in form %}
    <div class="card bg-light mb-3 col-lg-6">

        <!-- texto de la pregunta-->
        <fieldset class="form-group">
            <div class="card-header" style="text-align: left;">
                <form action="/edit_pregunta/{{id}}/{{question.0}}" method="POST">
                    <div class="input-group">
                        <a href="/delete_pregunta/{{id}}/{{question.0}}" class="btn btn-danger btn-sm">x</a>
                        <input type="text" style="border: 0;" class="form-control form-control-sm" name="pregunta" value="{{question.4}}">
                        <button type="submit" class="btn btn-sm  btn-success">+</button>
                    </div>
                </form>
            </div>
        </fieldset>

        <div class="card-body" style="text-align: left;">
            <!-- <div style="text-align: right;" class="text-muted">ID: {{question.0}}</div> -->
            <!-- cambia la presentacion dependiendo del tipo de pregunta -->
            <!-- Pregunta texto -->
            {% if question.3 == 0 %}
            <textarea class="form-control" id="exampleTextarea" rows="1"></textarea>
            {% endif %}

            <!-- Pregunta alternaiva -->
            {% if question.3 == 1 %}

            <!--  Formulario para agregar alternativas -->
            <form action="/new_alternativa/{{id}}/{{question.0}}" method="POST">
                <div class="input-group mb-3">
                    <input type="text" class="form-control form-control-sm" name="alternativa" placeholder="Selección">
                    <button type="submit" class="btn btn-primary btn-primary-sm" type="button">AGREGAR</button>
                </div>
            </form>

            <!-- visualizar las respuestas -->
            <form>
                <fieldset class="form-group">
                    {% for respuesta in question.2 %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                        <label class="form-check-label" for="flexCheckDefault">
                            <a href="/delete_alternativa/{{id}}/{{respuesta.0}}"
                                class="btn btn-danger btn-sm rounded-pill">×</a>
                            {{respuesta.2}}

                        </label>
                    </div>
                    {% endfor %}
                </fieldset>
            </form>
            {% endif %}

            <!-- Pregunta s.multiple -->
            {% if question.3 == 2 %}

            <!--  Formulario para agregar alternativas -->
            <form action="/new_alternativa/{{id}}/{{question.0}}" method="POST">
                <div class="input-group mb-3">
                    <input type="text" class="form-control form-control-sm" name="alternativa"
                        placeholder="Alternativa">
                    <button type="submit" class="btn btn-primary btn-primary-sm" type="button">AGREGAR</button>
                </div>
            </form>

            <!-- visualizar las respuestas -->
            <form>
                <fieldset class="form-group">

                    {% for respuesta in question.2 %}

                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="radio" class="form-check-input" name="optionsRadios" id="optionsRadios1"
                                value="option1">
                            <a href="/delete_alternativa/{{id}}/{{respuesta.0}}"
                                class="btn btn-danger btn-sm rounded-pill">×</a>
                            {{respuesta.2}}

                        </label>
                    </div>
                    {% endfor %}
                </fieldset>
            </form>
            {% endif %}

            <!-- Para editar y borrar preguntas 
                NO COMPLETADOS
                <a href="edit/{{ question.0 }}" class="mt-2 btn btn-primary">EDIT</a>
                <a href="delete/{{ question.0 }}" class="mt-2 btn btn-danger">DELETE</a>
                -->
        </div>
    </div>
    {% endfor %}
    <div>
        <a href="/forms" class="mt-2 btn btn-primary">VOLVER</a>

        <form action="/cerrar_encuesta/{{id}}" method="POST">
            <button class="mt-2 btn btn-primary">CERRAR ENCUESTA</button>
        </form>
    </div>
    <p></p>
</center>
{% endblock %}